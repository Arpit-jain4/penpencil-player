/*! @name videojs-setting-menu @version 1.0.0 @license MIT */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],t):(e=e||self).videojsSettingMenu=t(e.videojs)}(this,function(e){"use strict";function t(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}e=e&&e.hasOwnProperty("default")?e.default:e;var s="showMainMenu",n="goToMainMenu",i="toggleRatioMenu",a="toggleSpeedMenu",l="toggleQualityMenu",o="changePlaybackRate",c="changePlayerQuality",r="changeAspectRatio",u=e.getComponent("Button"),d={},p=function(n){function i(t,s){var i;return(i=n.call(this,t,s)||this).options=e.mergeOptions(d,s),i}t(i,n);var a=i.prototype;return a.buildCSSClass=function(){return"vjs-setting-menu-button vjs-icon-cog "+n.prototype.buildCSSClass.call(this)},a.handleClick=function(e){this.player_.trigger(s,{}),e.target.classList.contains("vjs-setting-button-anim")?e.target.classList.remove("vjs-setting-button-anim"):e.target.classList.add("vjs-setting-button-anim")},i}(u);p.defaultState={},p.VERSION="1.0.0",e.registerComponent("settingButton",p);var v=e.getComponent("ClickableComponent"),m={},g=function(s){function n(t,n){var i;return(i=s.call(this,t,n)||this).options=e.mergeOptions(m,n),i}t(n,s);var i=n.prototype;return i.createEl=function(){return e.dom.createEl("div",{className:"vjs-setting-item",innerHTML:this.options_.innerHTML})},i.handleClick=function(e){switch(this.player().trigger(this.options_.event,this.options_.value),this.options_.event){case o:this.playbackRateDomMod(e,this.options_.value);break;case c:this.qualityDomMod(e,this.options_.value);break;case r:this.aspectDomMod(e,this.options_.value)}},i.playbackRateDomMod=function(e,t){document.getElementsByClassName("vjs-setting-speed")[0].innerHTML=1===t?"Normal":t+"x",document.getElementsByClassName("vjs-speed vjs-icon-circle-inner-circle")[0].classList.add("vjs-icon-circle-outline"),document.getElementsByClassName("vjs-speed vjs-icon-circle-inner-circle")[0].classList.remove("vjs-icon-circle-inner-circle"),e.target&&e.target.children.length>1?(e.target.children[1].classList.add("vjs-icon-circle-inner-circle"),e.target.children[1].classList.remove("vjs-icon-circle-outline")):(e.currentTarget.children[1].classList.add("vjs-icon-circle-inner-circle"),e.currentTarget.children[1].classList.remove("vjs-icon-circle-outline"))},i.qualityDomMod=function(e,t){document.getElementsByClassName("vjs-setting-quality")[0].innerHTML="Auto"===t.label?"Auto":t.label+"p",document.getElementsByClassName("vjs-quality vjs-icon-circle-inner-circle")[0].classList.add("vjs-icon-circle-outline"),document.getElementsByClassName("vjs-quality vjs-icon-circle-inner-circle")[0].classList.remove("vjs-icon-circle-inner-circle"),e.target&&e.target.children.length>1?(e.target.children[1].classList.add("vjs-icon-circle-inner-circle"),e.target.children[1].classList.remove("vjs-icon-circle-outline")):(e.currentTarget.children[1].classList.add("vjs-icon-circle-inner-circle"),e.currentTarget.children[1].classList.remove("vjs-icon-circle-outline"))},i.aspectDomMod=function(e,t){document.getElementsByClassName("vjs-setting-ratio")[0].innerHTML=t,document.getElementsByClassName("vjs-ratio vjs-icon-circle-inner-circle")[0].classList.add("vjs-icon-circle-outline"),document.getElementsByClassName("vjs-ratio vjs-icon-circle-inner-circle")[0].classList.remove("vjs-icon-circle-inner-circle"),e.target&&e.target.children.length>1?(e.target.children[1].classList.add("vjs-icon-circle-inner-circle"),e.target.children[1].classList.remove("vjs-icon-circle-outline")):(e.currentTarget.children[1].classList.add("vjs-icon-circle-inner-circle"),e.currentTarget.children[1].classList.remove("vjs-icon-circle-outline"))},i.dispose=function(){s.prototype.dispose.call(this)},n}(v);g.defaultState={},g.VERSION="1.0.0",e.registerComponent("settingMenuSubItem",g);var h=e.getComponent("Menu"),j=e.getComponent("Component"),y={},f=function(s){function n(t,n){var i;(i=s.call(this,t,n)||this).options=e.mergeOptions(y,n);var a=i.options_.options||[];return i.update(a),i.el().classList.add("vjs-hidden"),i}t(n,s);var i=n.prototype;return i.createEl=function(){return e.dom.createEl("div",{className:"vjs-settings-menu-"+this.options_.name+" "})},i.update=function(e){var t=this.createMenu(e);this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=t,this.addChild(t)},i.createMenu=function(e){var t=new h(this.player(),{contentElType:"div"});if(e&&e.length)for(var s=0;s<e.length;s++){var n=new g(this.player(),e[s]);t.addChild(n)}return t},i.dispose=function(){s.prototype.dispose.call(this)},n}(j);f.defaultState={},f.VERSION="1.0.0",e.registerComponent("settingMenuItem",f);var L=e.getComponent("Menu"),C=e.getComponent("Component"),M={menu:["speed","quality"],speed:[],aspectRatio:["16:9","4:3"],sources:[],defaultQuality:"default"},b=function(u){function d(t,d){var p;return(p=u.call(this,t,d)||this).options=e.mergeOptions(M,d),p.el().classList.add("vjs-hidden"),t.on("ready",function(){console.log("ready"),p.getSpeedList(),p.getRatioList(),p.getQualityList(),p.update()}),t.on("loadedmetadata",function(){console.log("loadedmetadata"),p.getSpeedList(),p.getRatioList(),p.getQualityList()}),t.on("userinactive",function(){var e=document.getElementsByClassName("vjs-setting-menu-main")[0],t=document.getElementsByClassName("vjs-settings-menu-home")[0],s=document.getElementsByClassName("vjs-settings-menu-speed")[0],n=document.getElementsByClassName("vjs-settings-menu-quality")[0];e.classList.add("vjs-hidden"),t.classList.add("vjs-hidden"),s.classList.add("vjs-hidden"),n.classList.add("vjs-hidden")}),t.on(s,function(){var e=document.getElementsByClassName("vjs-setting-menu-main")[0],t=document.getElementsByClassName("vjs-settings-menu-home")[0],s=document.getElementsByClassName("vjs-settings-menu-speed")[0],n=document.getElementsByClassName("vjs-settings-menu-quality")[0];t.classList.contains("vjs-hidden")?(e.classList.remove("vjs-hidden"),t.classList.remove("vjs-hidden"),s.classList.add("vjs-hidden"),n.classList.add("vjs-hidden")):(e.classList.add("vjs-hidden"),t.classList.add("vjs-hidden"),s.classList.add("vjs-hidden"),n.classList.add("vjs-hidden"))}),t.on(a,function(){document.getElementsByClassName("vjs-settings-menu-home")[0].classList.add("vjs-hidden"),document.getElementsByClassName("vjs-settings-menu-speed")[0].classList.remove("vjs-hidden")}),t.on(i,function(){document.getElementsByClassName("vjs-settings-menu-home")[0].classList.add("vjs-hidden"),document.getElementsByClassName("vjs-settings-menu-ratio")[0].classList.remove("vjs-hidden")}),t.on(l,function(){document.getElementsByClassName("vjs-settings-menu-home")[0].classList.add("vjs-hidden"),document.getElementsByClassName("vjs-settings-menu-quality")[0].classList.remove("vjs-hidden")}),t.on(n,function(){document.getElementsByClassName("vjs-settings-menu-home")[0].classList.remove("vjs-hidden"),document.getElementsByClassName("vjs-settings-menu-speed")[0].classList.add("vjs-hidden"),document.getElementsByClassName("vjs-settings-menu-quality")[0].classList.add("vjs-hidden"),document.getElementsByClassName("vjs-settings-menu-ratio")[0].classList.add("vjs-hidden")}),t.on(o,function(e,t){p.player().playbackRate(t||1)}),t.on(r,function(e,t){console.log(r,t),p.player().aspectRatio(t||"16:9")}),t.on(c,function(e,t){var s=p.player().paused(),n=p.player().currentTime();p.player().src(t),p.player().ready(function(){s||p.player().play(),p.player().currentTime(n)})}),p}t(d,u);var p=d.prototype;return p.createEl=function(){return e.dom.createEl("div",{className:"vjs-setting-menu-main"})},p.update=function(){var e=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=e,this.addChild(e)},p.createMenu=function(){var e=new L(this.player(),{contentElType:"div"}),t=[{name:"home",options:this.getHomeMenu()},{name:"speed",options:this.getSpeedMenu()},{name:"ratio",options:this.getRatioMenu()},{name:"quality",options:this.getQualityMenu()}];if(t&&t.length)for(var s=0;s<t.length;s++)e.addChild(new f(this.player_,t[s]));return e},p.getSpeedList=function(){var e=this.player().options_.playerOptions.playbackRates,t=this.player().playbackRate();this.options_.speed=e,this.options_.currentPlaybackSpeed=t},p.getRatioList=function(){this.options_.aspectRatio=["16:9","4:3"],this.options_.currentRatio="16:9"},p.getQualityList=function(){var e=this.player().currentSource();if(e&&"application/x-mpegURL"===e.type&&this.player().hls){var t=this.player().hls.representations();if(!t.length||e.src===t[0].id)return;this.options_.sources=t.map(function(e){return{src:!e.id||5!==e.id.split(":")[0].length&&4!==e.id.split(":")[0].length?e.id.substr(2,e.id.length-1):e.id,label:e.height?e.height.toString():"240",type:"application/x-mpegURL"}}),this.options_.sources.push({src:e.src,label:"Auto",type:"application/x-mpegURL"}),this.options_.defaultQuality="Auto"}else if(e&&"video/mp4"===e.type){var s=[];this.player().currentSources().forEach(function(e){e&&e.label&&s.push({src:e.src,label:e.label,type:e.type})}),this.options_.sources=s,this.options_.defaultQuality=e.label?e.label+"p":"Auto"}this.options_.sources&&this.options_.sources.length&&(this.options_.sources=this.options_.sources.sort(function(e,t){return parseInt(t.label,10)-parseInt(e.label,10)})),this.update()},p.playDefaultQuality=function(e,t,s){var n=[];(n="default"!==s&&t&&t.label!==s?e.filter(function(e){return e.label===s}):[e[e.length-1]]).length&&this.player().trigger(c,n[0])},p.getQualityMenu=function(){var e=this.player().currentSource(),t=(this.options_.sources||[]).map(function(t){return{name:"Auto"===t.label?"Auto":t.label+"p",value:t,isSelected:t.label===e.src||"Auto"===t.label,className:t.label===e.label||"Auto"===t.label?"vjs-icon-circle-inner-circle":"vjs-icon-circle-outline",event:c,innerHTML:'<span class="vjs-setting-title">'+("Auto"===t.label?"Auto":t.label+"p")+'</span>\n<span class="vjs-setting-icon vjs-quality '+(t.label===e.label||"Auto"===t.label?"vjs-icon-circle-inner-circle":"vjs-icon-circle-outline")+'"></span>'}});return t.splice(0,0,{name:"Quality",value:"Quality",isSelected:!1,className:"vjs-icon-play",event:n,innerHTML:'<span style="transform: rotate(180deg);" class="vjs-setting-icon vjs-icon-play"></span>\n                    <span class="vjs-setting-title">Quality</span>'}),t},p.getSpeedMenu=function(){var e=this.options_.speed,t=this.options_.currentPlaybackSpeed;if(e&&t){var s=e.map(function(e){return{name:e+"x",value:e,isSelected:e===t,className:e===t?"vjs-icon-circle-inner-circle":"vjs-icon-circle-outline",event:o,innerHTML:'<span class="vjs-setting-title">'+(1===e?"Normal":e+"x")+'</span>\n<span class="vjs-setting-icon vjs-speed '+(e===t?"vjs-icon-circle-inner-circle":"vjs-icon-circle-outline")+'"></span>'}});return s.splice(0,0,{name:"Speed",value:"Speed",isSelected:!1,className:"vjs-icon-play",event:n,innerHTML:'<span style="transform: rotate(180deg);" class="vjs-setting-icon vjs-icon-play"></span>\n                    <span class="vjs-setting-title">Speed</span>'}),s}},p.getRatioMenu=function(){var e=this.options_.aspectRatio,t=this.options_.currentRatio;if(e&&t){var s=e.map(function(e){return{name:e,value:e,isSelected:e===t,className:e===t?"vjs-icon-circle-inner-circle":"vjs-icon-circle-outline",event:r,innerHTML:'<span class="vjs-setting-title">'+(1===e?"Normal":e+"x")+'</span>\n<span class="vjs-setting-icon vjs-ratio '+(e===t?"vjs-icon-circle-inner-circle":"vjs-icon-circle-outline")+'"></span>'}});return s.splice(0,0,{name:"Ratio",value:"Ratio",isSelected:!1,className:"vjs-icon-play",event:n,innerHTML:'<span style="transform: rotate(180deg);" class="vjs-setting-icon vjs-icon-play"></span>\n                    <span class="vjs-setting-title">Ratio</span>'}),s}},p.getHomeMenu=function(){if(this.options.menu&&this.options.menu.length){var e=[],t=this.options.menu.map(function(e){return e.toString().toLowerCase()});return t.indexOf("share")>-1&&e.push({name:"Share",value:0,event:a,innerHTML:'<span class="vjs-setting-title">Share</span>\n<span class="vjs-setting-icon vjs-icon-share"></span>'}),t.indexOf("zoom")>-1&&e.push({name:"Zoom",class:"vjs-icon-spinner",value:0,event:a,innerHTML:'<span class="vjs-setting-title">Zoom</span>\n<span class="vjs-setting-icon vjs-icon-spinner"></span>'}),t.indexOf("related")>-1&&e.push({name:"Related",class:"vjs-icon-chapters",value:0,event:a,innerHTML:'<span class="vjs-setting-title text-left">Related</span>\n<span class="vjs-setting-icon vjs-icon-chapters"></span>'}),t.indexOf("aspect-ratio")>-1&&this.options_.aspectRatio&&this.options_.aspectRatio.length&&e.push({name:"Ratio",class:"",value:"16:9",event:i,innerHTML:'<span class="vjs-setting-title text-left">Ratio</span>\n<span class="vjs-setting-icon vjs-setting-ratio">16:9</span>'}),t.indexOf("speed")>-1&&this.options_.speed&&this.options_.speed.length&&e.push({name:"Speed",class:"",value:"Normal",event:a,innerHTML:'<span class="vjs-setting-title text-left">Speed</span>\n<span class="vjs-setting-icon vjs-setting-speed">Normal</span>'}),t.indexOf("quality")>-1&&this.options_.sources&&this.options_.sources.length&&e.push({name:"Quality",class:"",value:"250p",event:l,innerHTML:'<span class="vjs-setting-title text-left">Quality</span>\n<span class="vjs-setting-icon vjs-setting-quality">'+(this.options_.defaultQuality||"default")+"</span>"}),e}},p.dispose=function(){u.prototype.dispose.call(this)},d}(C);b.defaultState={},b.VERSION="1.0.0",e.registerComponent("settingMenuMain",b);var N=e.getPlugin("plugin"),S={},B=function(s){function n(t,n){var i;return(i=s.call(this,t)||this).options=e.mergeOptions(S,n),i.player.ready(function(){i.player.addClass("vjs-setting-menu"),i.player.controlBar.settingButton=i.player.controlBar.addChild("settingButton"),i.player.controlBar.el().insertBefore(i.player.controlBar.settingButton.el(),i.player.controlBar.fullscreenToggle.el()),i.player.controlBar.settingButton=i.player.controlBar.addChild("settingMenuMain")}),i}return t(n,s),n}(N);return B.defaultState={},B.VERSION="1.0.0",e.registerPlugin("settingMenu",B),B});
